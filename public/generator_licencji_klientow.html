<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Generator licencji</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen">
  <div class="bg-gray-800 p-6 rounded-2xl w-full max-w-md">
    <h1 class="text-xl font-bold mb-4">Generator licencji (Admin)</h1>

    <button id="generateBtn" class="bg-red-600 hover:bg-red-700 px-4 py-3 rounded-xl font-semibold w-full">Wygeneruj licencję</button>
    <button id="clearBtn" class="bg-gray-600 hover:bg-gray-700 px-4 py-3 rounded-xl font-semibold w-full mt-2">Wyczyść dane</button>

    <div id="newLicense" class="mt-4 text-center text-lg font-mono"></div>

    <h2 class="text-lg font-semibold mt-6 mb-2">Wygenerowane licencje:</h2>
    <ul id="licenseList" class="list-disc pl-5 space-y-1 text-sm"></ul>
  </div>

  <script>
  const btn = document.getElementById("generateBtn");
  const clearBtn = document.getElementById("clearBtn");
  const output = document.getElementById("newLicense");
  const list = document.getElementById("licenseList");
  
  const GENERATE_LICENSE_URL = "https://licencje-serwer.onrender.com/api/generuj-licencje";
const LICENSE_LIST_URL = "https://licencje-serwer.onrender.com/api/lista-licencji";
const CLEAR_LICENSES_URL = "https://licencje-serwer.onrender.com/api/wyczysc-licencje";

  function fetchAndRenderLicenses() {
    fetch(LICENSE_LIST_URL)
    .then(response => response.json())
    .then(licenses => {
      list.innerHTML = "";
      licenses.forEach(lic => {
        const li = document.createElement("li");
        li.textContent = lic;
        list.appendChild(li);
      });
    });
  }

  fetchAndRenderLicenses();

  btn.addEventListener("click", () => {
    fetch(GENERATE_LICENSE_URL, {
        method: "POST"
    })
    .then(response => response.json())
    .then(data => {
        output.textContent = "Nowa licencja: " + data.kod;
        fetchAndRenderLicenses();
    });
  });

  clearBtn.addEventListener("click", () => {
    fetch(CLEAR_LICENSES_URL, { method: "POST" })
      .then(response => response.json())
      .then(data => {
        output.textContent = data.message;
        fetchAndRenderLicenses();
      });
  });
</script>
</body>
</html>

